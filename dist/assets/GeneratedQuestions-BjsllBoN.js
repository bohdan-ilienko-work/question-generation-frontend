import{b as _,a as B,i as z,k as H,r as h,l as U,m as V,n as $,o as W,p as J,q as K,t as X,j as e,v as f,w as Y}from"./index-DjN2_nU2.js";import{M as Z,P as ee}from"./MapWithMarker-CgYDFgPR.js";import{L as se}from"./Loader-IoDMyHJv.js";const le=()=>{const g=_(),C=B(),{limit:b,page:c,totalPages:v}=z(),{data:o,error:m,isLoading:k,refetch:S}=H({limit:b,page:c}),N=h.useRef(!0),[x,d]=h.useState(new Set),[n,u]=h.useState({category:"",title:"",difficulty:"",status:"",localeIncluded:"",localeExcluded:"",tags:""});h.useEffect(()=>{N.current||S(),N.current=!1},[b,c]);const[Q]=U(),[E]=V(),[G]=$(),[A,{isLoading:w}]=W(),[i,y]=h.useState(null),[O]=J(),[M]=K(),[I]=X(),q=s=>{d(t=>{const r=new Set(t);return r.has(s)?r.delete(s):r.add(s),r})},R=async s=>{try{const t=await G({questionId:s}).unwrap();t.responseObject&&t.responseObject.suggestion?y(r=>r?[...r,{questionId:s,suggestion:t.responseObject.suggestion}]:[{questionId:s,suggestion:t.responseObject.suggestion}]):alert("No suggestions available")}catch(t){console.error("Error checking correctness:",t)}},F=async s=>{var l;const t=(l=i==null?void 0:i.find(a=>a.questionId===s))==null?void 0:l.suggestion;if(!t)return;const r=o==null?void 0:o.responseObject.questions.find(a=>a._id===s);if(!r)return;const j={...r,locales:[{...r.locales[0],question:t.question,correct:t.correct,wrong:t.wrong}]};try{await I(j).unwrap(),y(a=>a?a.filter(p=>p.questionId!==s):null)}catch(a){console.error("Error accepting suggestion:",a)}},P=()=>{O(Array.from(x)),d(new Set)},L=()=>{M(Array.from(x)),d(new Set)},D=async()=>{try{const s=await A({questionIds:Array.from(x)}).unwrap();if(s.responseObject&&!s.responseObject.find(t=>t.suggestion!==null))return alert("No suggestions available");s.responseObject&&Array.isArray(s.responseObject)&&(y(t=>t?[...t,...s.responseObject.map(r=>{if(r.suggestion)return{questionId:r.questionId,suggestion:r.suggestion}}).filter(r=>r!==void 0)]:s.responseObject.map(r=>{if(r.suggestion)return{questionId:r.questionId,suggestion:r.suggestion}}).filter(r=>r!==void 0)),d(new Set))}catch(s){console.error("Error checking correctness:",s),s instanceof Error?alert(`Error checking correctness: ${s.message}`):alert("Error checking correctness: Unknown error")}};return k?e.jsx(se,{}):m?e.jsxs("p",{children:["Error:"," ",m&&"data"in m?m.data.message:"An error occurred"]}):e.jsxs("div",{className:"flex flex-col items-center space-y-2 w-full",children:[e.jsxs("div",{className:"bg-white p-2 rounded-md shadow-md flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Category"}),e.jsxs("select",{value:n.category,onChange:s=>u({...n,category:s.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"science",children:"Science"}),e.jsx("option",{value:"art",children:"Art"}),e.jsx("option",{value:"history",children:"History"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Question Title"}),e.jsx("input",{type:"text",value:n.title,onChange:s=>u({...n,title:s.target.value}),className:"w-full p-2 border rounded-md",placeholder:"Enter question title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Generated After"}),e.jsx("input",{type:"date",className:"w-full p-2 border rounded-md",placeholder:"Enter date..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Generated Before"}),e.jsx("input",{type:"date",className:"w-full p-2 border rounded-md",placeholder:"Enter date..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Temperature"}),e.jsx("input",{type:"number",min:"0",max:"2",step:".1",className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Difficulty"}),e.jsxs("select",{value:n.difficulty,onChange:s=>u({...n,difficulty:s.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"1 (Easy)"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3 (Medium)"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"5",children:"5 (Hard)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Status"}),e.jsxs("select",{value:n.status,onChange:s=>u({...n,status:s.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Must have locale"}),e.jsxs("select",{value:n.localeIncluded,onChange:s=>u({...n,localeIncluded:s.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Must NOT have locale"}),e.jsxs("select",{value:n.localeExcluded,onChange:s=>u({...n,localeExcluded:s.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Tags"}),e.jsx("input",{type:"text",value:n.tags,onChange:s=>u({...n,tags:s.target.value}),className:"w-full p-2 border rounded-md",placeholder:"Enter tags (comma separated)..."})]})]}),x.size>0&&e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx("button",{className:"bg-green-500 text-white px-3 py-1 rounded-md",onClick:P,children:"Accept Selected"}),e.jsx("button",{className:"bg-red-500 text-white px-3 py-1 rounded-md",onClick:L,children:"Reject Selected"}),e.jsx("button",{className:"bg-blue-500 text-white px-3 py-1 rounded-md",onClick:D,disabled:w,children:w?"Checking...":"Check Correctness of Selected"}),e.jsx("button",{className:"bg-gray-500 text-white px-3 py-1 rounded-md",onClick:()=>d(new Set),children:"Deselect All"})]}),e.jsx("h3",{className:"text-lg font-semibold",children:"Generated Questions"}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-300 bg-white shadow-md rounded-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:e.jsx("input",{type:"checkbox",onChange:s=>{s.target.checked?d(new Set(o==null?void 0:o.responseObject.questions.map(t=>t._id))):d(new Set)},checked:x.size===(o==null?void 0:o.responseObject.questions.length)})}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"ID"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Question"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Answers"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Difficulty"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Status"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Type"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 w-1/7",children:"Actions"})]})}),e.jsx("tbody",{children:o==null?void 0:o.responseObject.questions.map(s=>{var r,j;const t=s._id;return e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:x.has(t),onChange:()=>q(t)})}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:t}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[s.locales[0].question," ",e.jsx("span",{className:"text-gray-500",children:i&&i.find(l=>l.questionId===t)&&e.jsxs("span",{className:"text-orange-500",children:["(Suggestion available):"," ",(r=i.find(l=>l.questionId===t))==null?void 0:r.suggestion.question]})})]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 w-1/4",children:s.type==="map"?e.jsx(Z,{position:[Number(s.locales[0].correct[0]),Number(s.locales[0].correct[1])]}):e.jsxs(e.Fragment,{children:[e.jsxs("ul",{className:"list-none grid grid-cols-2 gap-4",children:[e.jsxs("li",{className:"font-bold text-green-600",children:["✔ ",s.locales[0].correct]}),(j=s.locales[0].wrong)==null?void 0:j.map((l,a)=>e.jsxs("li",{children:["✗ ",l]},a))]}),i&&(()=>{var a;const l=i.find(p=>p.questionId===t);return l?e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"my-2 border-t border-gray-300"}),"(Suggestion available):",e.jsxs("ul",{className:"list-none grid grid-cols-2 gap-4",children:[e.jsxs("li",{className:"font-bold text-green-600",children:["✔ ",l.suggestion.question]}),(a=l.suggestion.wrong)==null?void 0:a.map((p,T)=>e.jsxs("li",{children:["✗ ",p]},T))]})]}):null})()]})}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.difficulty}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.status}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.type.replace("_"," ")}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 grid grid-cols-2 gap-4",children:[e.jsx("button",{className:"bg-orange-500 text-white px-3 py-1 rounded-md",onClick:()=>Q(t),children:"Accept"}),e.jsx("button",{className:"bg-red-500 text-white px-3 py-1 rounded-md",onClick:()=>E(t),children:"Reject"}),e.jsxs("button",{className:"bg-blue-500 text-white px-3 py-1 rounded-md flex items-center gap-2",onClick:()=>C(`/edit-generated-question/${t}`),children:["Edit ",e.jsx(ee,{size:16})]}),e.jsx("button",{className:"bg-gray-500 text-white px-3 py-1 rounded-md",onClick:()=>R(t),children:"Check"}),i&&i.find(l=>l.questionId===t)&&e.jsx("button",{className:"bg-green-500 text-white px-3 py-1 rounded-md",onClick:()=>F(t),children:"Accept Suggestion"}),s.source&&e.jsx("button",{className:"bg-blue-500 text-white px-3 py-1 rounded-md",onClick:()=>window.open(s.source,"_blank"),children:"Source"})]})]},t)})})]})}),e.jsxs("div",{className:"flex space-x-4 mt-4",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded disabled:opacity-50",onClick:()=>g(f(c>1?c-1:1)),disabled:c===1,children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 text-lg font-semibold",children:["Page ",c," of ",v||1]}),e.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded disabled:opacity-50",onClick:()=>g(f(c+1)),disabled:c>=v,children:"Next"}),e.jsxs("div",{className:"px-4 py-2 bg-gray-300 rounded",children:[e.jsx("span",{children:"Items per page:"}),e.jsxs("select",{value:b,onChange:s=>{g(Y(+s.target.value)),g(f(1))},className:"px-4 py-2 bg-gray-300 rounded",children:[e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"})]})]})]})]})};export{le as default};
