import{a as F,K as I,a4 as S,a5 as A,r as E,j as a}from"./index-DjN2_nU2.js";import{F as g,I as h,R as M,C as R}from"./index-ClWMkrtQ.js";import{C as U,T as B,S as D}from"./index-DQjUNnms.js";import{B as l}from"./CheckOutlined-Cn2jBBnW.js";import{S as y}from"./index-Dsd4Wkat.js";const{Option:G}=y,{Title:P,Text:p}=B,o=["en","uk","es","ru","fr","de","it","pl","tr"];function $(){const x=F(),{parentId:i}=I(),[f,{isLoading:d}]=S(),[j,{isLoading:C}]=A(),[m]=g.useForm(),[t,r]=E.useState([{language:"en",value:""}]),b=()=>{const n=t.map(s=>s.language),e=o.find(s=>!n.includes(s));e&&r([...t,{language:e,value:""}])},v=n=>{r(t.filter(e=>e.language!==n))},w=(n,e)=>{t.some(s=>s.language===e)||r(t.map(s=>s.language===n?{...s,language:e}:s))},k=async n=>{try{const s=(await j({requiredLocales:o.filter(c=>!t.some(u=>u.language===c)),originalText:n,sourceLanguage:t[0].language}).unwrap()).responseObject;r(c=>[...c,...s.filter(u=>!c.some(T=>T.language===u.language))])}catch(e){const s=e instanceof Error?e.message:"Unknown error";alert("Failed to translate category: "+s)}},L=(n,e)=>{r(t.map(s=>s.language===n?{...s,value:e}:s))},N=async n=>{try{await f({name:n.name,parentId:Number(i),locales:t}).unwrap(),m.resetFields(),r([{language:"en",value:""}]),alert("Category created successfully"),x("/categories-crud")}catch(e){const s=e instanceof Error?e.message:"Unknown error";alert("Failed to create category: "+s)}};return a.jsx("div",{className:"flex justify-center bg-gray-100 p-6 h-full",children:a.jsxs(U,{className:"w-full max-w-3xl",children:[a.jsxs(P,{level:4,className:"flex justify-between items-center",children:[a.jsx("span",{children:"Create Category"}),a.jsx(l,{type:"link",onClick:()=>window.history.back(),children:"Back"})]}),i&&a.jsxs(p,{type:"secondary",className:"block mb-4",children:[a.jsx("strong",{children:"Parent ID:"})," ",i]}),a.jsxs(g,{form:m,layout:"vertical",onFinish:N,children:[a.jsx(g.Item,{label:"Category Name",name:"name",rules:[{required:!0,message:"Please enter category name"}],children:a.jsx(h,{placeholder:"Default category name"})}),a.jsxs("div",{className:"mb-2 flex justify-between items-center",children:[a.jsx(p,{strong:!0,children:"Locales"}),a.jsx(l,{type:"link",loading:C,disabled:t.length===o.length,onClick:()=>k(t[0].value),children:"Generate locales (by DeepL)"})]}),a.jsx(M,{gutter:[16,16],children:t.map(n=>a.jsx(R,{xs:24,sm:12,children:a.jsxs(D,{align:"start",className:"w-full",children:[a.jsx(y,{value:n.language,onChange:e=>w(n.language,e),style:{width:100},children:o.map(e=>a.jsx(G,{value:e,disabled:t.some(s=>s.language===e&&s.language!==n.language),children:e.toUpperCase()},e))}),a.jsx(h,{placeholder:`Value for ${n.language}`,value:n.value,onChange:e=>L(n.language,e.target.value),className:"w-full"}),t.length>1&&a.jsx(l,{type:"link",danger:!0,onClick:()=>v(n.language),children:"âœ•"})]})},n.language))}),t.length<o.length&&a.jsx(l,{type:"link",onClick:b,className:"mt-2",children:"+ Add locale"}),a.jsx(g.Item,{style:{marginTop:16},children:a.jsx(l,{type:"primary",htmlType:"submit",loading:d,children:d?"Creating...":"Create Category"})})]})]})})}export{$ as default};
