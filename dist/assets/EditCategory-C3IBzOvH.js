import{K as S,a as U,a6 as O,a7 as A,a5 as M,r as f,j as a}from"./index-JQf8uTBS.js";import{F as u,I as x,R as B,C as G}from"./index-BNdrPFU3.js";import{C as R,T as D,S as V}from"./index-BVwZHRgl.js";import{B as l}from"./CheckOutlined-IEi1jn8g.js";import{S as j}from"./index-BT9NWaBK.js";import{s as p}from"./index-BdHDmdvj.js";const{Option:q}=j,{Title:P,Text:$}=D,g=["en","uk","es","ru","fr","de","it","pl","tr"];function W(){const{categoryId:d}=S(),m=U(),[h]=u.useForm(),{data:o,isLoading:C}=O({categoryId:Number(d)}),[b,{isLoading:y}]=A(),[w,{isLoading:v}]=M(),[n,i]=f.useState([]);f.useEffect(()=>{o!=null&&o.responseObject&&(h.setFieldsValue({name:o.responseObject.name}),i(o.responseObject.locales))},[o]);const L=()=>{const t=n.map(s=>s.language),e=g.find(s=>!t.includes(s));e&&i([...n,{language:e,value:""}])},k=t=>{i(n.filter(e=>e.language!==t))},N=(t,e)=>{n.some(s=>s.language===e)||i(n.map(s=>s.language===t?{...s,language:e}:s))},T=async t=>{try{const e=await w({requiredLocales:g.filter(c=>!n.some(r=>r.language===c)),originalText:t,sourceLanguage:n[0].language}).unwrap(),s=Object.entries(e.responseObject).map(([c,r])=>({language:c,value:typeof r=="string"?r:r.value}));i(c=>[...c,...s.filter(r=>!c.some(F=>F.language===r.language))])}catch(e){const s=e instanceof Error?e.message:"Unknown error";p.error("Failed to translate category: "+s)}},E=(t,e)=>{i(n.map(s=>s.language===t?{...s,value:e}:s))},I=async t=>{try{await b({categoryId:Number(d),name:t.name,locales:n}).unwrap(),p.success("Category updated successfully"),m("/categories-crud")}catch(e){const s=e instanceof Error?e.message:"Unknown error";p.error("Failed to update category: "+s)}};return a.jsx("div",{className:"flex justify-center bg-gray-100 p-6 h-full",children:a.jsxs(R,{className:"w-full max-w-3xl",children:[a.jsxs(P,{level:4,className:"flex justify-between items-center",children:[a.jsx("span",{children:"Edit Category"}),a.jsx(l,{type:"link",onClick:()=>window.history.back(),children:"Back"})]}),a.jsxs(u,{form:h,layout:"vertical",onFinish:I,children:[a.jsx(u.Item,{label:"Category Name",name:"name",rules:[{required:!0,message:"Please enter category name"}],children:a.jsx(x,{placeholder:"Default category name"})}),a.jsxs("div",{className:"mb-2 flex justify-between items-center",children:[a.jsx($,{strong:!0,children:"Locales"}),a.jsx(l,{type:"link",loading:v,disabled:n.length===g.length,onClick:()=>T(n[0].value),children:"Generate locales (by DeepL)"})]}),a.jsx(B,{gutter:[16,16],children:n.map(t=>a.jsx(G,{xs:24,sm:12,children:a.jsxs(V,{align:"start",className:"w-full",children:[a.jsx(j,{value:t.language,onChange:e=>N(t.language,e),style:{width:100},children:g.map(e=>a.jsx(q,{value:e,disabled:n.some(s=>s.language===e&&s.language!==t.language),children:e.toUpperCase()},e))}),a.jsx(x,{placeholder:`Value for ${t.language}`,value:t.value,onChange:e=>E(t.language,e.target.value),className:"w-full"}),n.length>1&&a.jsx(l,{type:"link",danger:!0,onClick:()=>k(t.language),children:"âœ•"})]})},t.language))}),n.length<g.length&&a.jsx(l,{type:"link",onClick:L,className:"mt-2",children:"+ Add locale"}),a.jsx(u.Item,{style:{marginTop:16},children:a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsx(l,{type:"default",onClick:()=>m("/categories-crud"),children:"Cancel"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(l,{type:"primary",htmlType:"submit",loading:y||C,children:y?"Updating...":"Update Category"}),a.jsx(l,{type:"primary",danger:!0,onClick:()=>m(`/categories-crud/delete/${d}`),children:"Delete Category"})]})]})})]})]})})}export{W as default};
